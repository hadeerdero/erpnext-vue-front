{"ast":null,"code":"import { axiosAuth } from \"@/plugins/axios/axiosAuth\";\nconst state = {\n  user: JSON.parse(localStorage.getItem(\"user\")) || null,\n  status: \"\",\n  // 'loading', 'success', 'error'\n  home_page: \"/app/home\" // Default home page\n};\nconst getters = {\n  isAuthenticated: state => !!state.user,\n  authStatus: state => state.status,\n  currentUser: state => state.user,\n  homePage: state => state.home_page,\n  fullName: state => state.user?.full_name || null\n};\nconst mutations = {\n  AUTH_REQUEST(state) {\n    state.status = \"loading\";\n  },\n  AUTH_SUCCESS(state, {\n    full_name,\n    home_page\n  }) {\n    state.status = \"success\";\n    state.user = {\n      full_name: full_name\n    };\n    state.home_page = home_page || \"/app/home\";\n\n    // Persist in localStorage\n    localStorage.setItem(\"user\", JSON.stringify(state.user));\n    localStorage.setItem(\"home_page\", state.home_page);\n  },\n  AUTH_ERROR(state) {\n    state.status = \"error\";\n    state.user = null;\n    localStorage.removeItem(\"user\");\n    localStorage.removeItem(\"home_page\");\n  },\n  LOGOUT(state) {\n    state.user = null;\n    state.home_page = \"/app/home\";\n    localStorage.removeItem(\"user\");\n    localStorage.removeItem(\"home_page\");\n  }\n};\nconst actions = {\n  async login({\n    commit\n  }, credentials) {\n    commit(\"AUTH_REQUEST\");\n    try {\n      const response = await axiosAuth.post(\"/api/method/login\", {\n        usr: credentials.email,\n        pwd: credentials.password\n      });\n      const {\n        full_name,\n        home_page\n      } = response.data;\n      commit(\"AUTH_SUCCESS\", {\n        full_name,\n        home_page: home_page || \"/app/home\"\n      });\n      return response.data;\n    } catch (error) {\n      commit(\"AUTH_ERROR\");\n      throw error;\n    }\n  },\n  async logout({\n    commit\n  }) {\n    try {\n      await axiosAuth.post(\"/api/method/frappe.auth.logout\");\n    } finally {\n      commit(\"LOGOUT\");\n    }\n  }\n};\nexport default {\n  namespaced: true,\n  state,\n  getters,\n  mutations,\n  actions\n};","map":{"version":3,"names":["axiosAuth","state","user","JSON","parse","localStorage","getItem","status","home_page","getters","isAuthenticated","authStatus","currentUser","homePage","fullName","full_name","mutations","AUTH_REQUEST","AUTH_SUCCESS","setItem","stringify","AUTH_ERROR","removeItem","LOGOUT","actions","login","commit","credentials","response","post","usr","email","pwd","password","data","error","logout","namespaced"],"sources":["D:/hadeerwork/erpnext-vue-front/src/store/modules/auth/auth.js"],"sourcesContent":["\r\nimport { axiosAuth } from \"@/plugins/axios/axiosAuth\";\r\n\r\nconst state = {\r\n  user: JSON.parse(localStorage.getItem(\"user\")) || null,\r\n  status: \"\", // 'loading', 'success', 'error'\r\n  home_page: \"/app/home\", // Default home page\r\n};\r\n\r\nconst getters = {\r\n  isAuthenticated: (state) => !!state.user,\r\n  authStatus: (state) => state.status,\r\n  currentUser: (state) => state.user,\r\n  homePage: (state) => state.home_page,\r\n  fullName: (state) => state.user?.full_name || null,\r\n};\r\n\r\nconst mutations = {\r\n  AUTH_REQUEST(state) {\r\n    state.status = \"loading\";\r\n  },\r\n  AUTH_SUCCESS(state, { full_name, home_page }) {\r\n    state.status = \"success\";\r\n    state.user = {\r\n      full_name: full_name,\r\n    };\r\n    state.home_page = home_page || \"/app/home\";\r\n\r\n    // Persist in localStorage\r\n    localStorage.setItem(\"user\", JSON.stringify(state.user));\r\n    localStorage.setItem(\"home_page\", state.home_page);\r\n  },\r\n  AUTH_ERROR(state) {\r\n    state.status = \"error\";\r\n    state.user = null;\r\n    localStorage.removeItem(\"user\");\r\n    localStorage.removeItem(\"home_page\");\r\n  },\r\n  LOGOUT(state) {\r\n    state.user = null;\r\n    state.home_page = \"/app/home\";\r\n    localStorage.removeItem(\"user\");\r\n    localStorage.removeItem(\"home_page\");\r\n  },\r\n};\r\n\r\nconst actions = {\r\n  async login({ commit }, credentials) {\r\n    commit(\"AUTH_REQUEST\");\r\n\r\n    try {\r\n      const response = await axiosAuth.post(\"/api/method/login\", {\r\n        usr: credentials.email,\r\n        pwd: credentials.password,\r\n      });\r\n\r\n      const { full_name, home_page } = response.data;\r\n\r\n      commit(\"AUTH_SUCCESS\", { \r\n        full_name, \r\n        home_page: home_page || \"/app/home\" \r\n      });\r\n\r\n      return response.data;\r\n    } catch (error) {\r\n      commit(\"AUTH_ERROR\");\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  async logout({ commit }) {\r\n    try {\r\n      await axiosAuth.post(\"/api/method/frappe.auth.logout\");\r\n    } finally {\r\n      commit(\"LOGOUT\");\r\n    }\r\n  },\r\n};\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  getters,\r\n  mutations,\r\n  actions,\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}